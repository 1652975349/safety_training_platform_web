<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>通知管理 - 安全培训平台</title>
    <link rel="stylesheet" href="../common/styles.css">
</head>
<body>
<!-- 顶部通栏 - 直接嵌入 -->
<header class="header">
    <div class="header-left">
        <div class="logo">安全培训平台</div>
        <div class="role-switcher">
            <button class="role-btn" onclick="switchRole('student')">学员端</button>
            <button class="role-btn active" onclick="switchRole('admin')">管理员端</button>
        </div>
    </div>
    <div class="header-right">
        <div class="user-info">
            <div class="avatar">👤</div>
            <span id="currentUser">管理员</span>
        </div>
        <button class="btn btn-secondary" onclick="logout()">退出</button>
    </div>
</header>

<!-- 左侧菜单 - 直接嵌入 -->
<nav class="sidebar" id="sidebar">
    <ul class="sidebar-menu" id="sidebarMenu">
        <li class="menu-item">
            <a href="dashboard_simple.html" class="menu-link">
                <span class="menu-icon">🏠</span>
                <span class="menu-text">首页</span>
            </a>
        </li>
        <li class="menu-item">
            <a href="personnel.html" class="menu-link">
                <span class="menu-icon">👥</span>
                <span class="menu-text">人员管理</span>
            </a>
        </li>
        <li class="menu-item">
            <a href="training.html" class="menu-link">
                <span class="menu-icon">📚</span>
                <span class="menu-text">培训管理</span>
            </a>
        </li>
        <li class="menu-item">
            <a href="content.html" class="menu-link">
                <span class="menu-icon">📄</span>
                <span class="menu-text">内容管理</span>
            </a>
        </li>
        <li class="menu-item">
            <a href="statistics.html" class="menu-link">
                <span class="menu-icon">📊</span>
                <span class="menu-text">统计分析</span>
            </a>
        </li>
        <li class="menu-item">
            <a href="settings.html" class="menu-link">
                <span class="menu-icon">⚙️</span>
                <span class="menu-text">系统设置</span>
            </a>
        </li>
        <li class="menu-item">
            <a href="notifications.html" class="menu-link active">
                <span class="menu-icon">🔔</span>
                <span class="menu-text">通知管理</span>
            </a>
        </li>
    </ul>
</nav>
    
    <!-- 主内容区域 -->
    <div class="main-content">
        <div class="content-header">
            <h1 class="page-title">通知管理</h1>
            <p class="page-subtitle">培训通知推送管理</p>
        </div>
        
        <!-- 操作工具栏 -->
        <div class="card">
            <div class="card-body">
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap; justify-content: space-between;">
                    <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="createNotification()">➕ 创建通知</button>
                        <!-- <button class="btn btn-success" onclick="sendNotification()">📤 发送通知</button> -->
                        <button class="btn btn-warning" onclick="scheduleNotification()">⏰ 定时发送</button>
                        <!-- <button class="btn btn-info" onclick="templateManagement()">📝 模板管理</button> -->
                    </div>
                    <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                        <div class="form-group" style="margin-bottom: 0; min-width: 150px;">
                            <select class="form-control">
                                <option value="">全部类型</option>
                                <option value="training">培训通知</option>
                                <option value="exam">考试通知</option>
                                <option value="system">系统通知</option>
                                <option value="reminder">催办通知</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-bottom: 0; min-width: 150px;">
                            <select class="form-control">
                                <option value="">全部状态</option>
                                <option value="draft">草稿</option>
                                <option value="sent">已发送</option>
                                <option value="scheduled">定时发送</option>
                            </select>
                        </div>
                        <button class="btn btn-secondary">🔍 筛选</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 通知统计 -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon blue">📢</div>
                <div class="stat-number">156</div>
                <div class="stat-label">总通知数</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon green">📤</div>
                <div class="stat-number">142</div>
                <div class="stat-label">已发送</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon orange">⏰</div>
                <div class="stat-number">8</div>
                <div class="stat-label">定时发送</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon red">📝</div>
                <div class="stat-number">6</div>
                <div class="stat-label">草稿</div>
            </div>
        </div>
        
        <!-- 通知列表 -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">通知列表</h2>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>
                                    <input type="checkbox" onchange="toggleSelectAll()">
                                </th>
                                <th>通知标题</th>
                                <th>类型</th>
                                <th>接收对象</th>
                                <th>发送时间</th>
                                <th>阅读率</th>
                                <th>状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="checkbox" class="notification-checkbox"></td>
                                <td>
                                    <div>
                                        <strong>消防安全考试通知</strong>
                                        <br>
                                        <small class="text-muted">提醒学员参加消防安全考试</small>
                                    </div>
                                </td>
                                <td><span class="badge badge-danger">考试通知</span></td>
                                <td>生产部全体学员</td>
                                <td>2024-01-16 09:00</td>
                                <td>
                                    <div class="progress" style="width: 100px;">
                                        <div class="progress-bar" style="width: 85%"></div>
                                    </div>
                                    <small>85%</small>
                                </td>
                                <td><span class="badge badge-success">已发送</span></td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="editNotification('消防安全考试通知', 'exam', '生产部全体学员', '2024-01-16 09:00', '已发送')">编辑</button>
                                    <button class="btn btn-secondary btn-sm" onclick="viewNotificationDetail('消防安全考试通知', 'exam', '生产部全体学员', '2024-01-16 09:00', '已发送', 85)">查看</button>
                                    <button class="btn btn-warning btn-sm" onclick="resendNotification('消防安全考试通知', 'EMP001')">重发</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteNotification('消防安全考试通知', 'EMP001')">删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="notification-checkbox"></td>
                                <td>
                                    <div>
                                        <strong>新培训课程发布</strong>
                                        <br>
                                        <small class="text-muted">化工安全培训课程已发布</small>
                                    </div>
                                </td>
                                <td><span class="badge badge-info">培训通知</span></td>
                                <td>技术部全体学员</td>
                                <td>2024-01-15 14:30</td>
                                <td>
                                    <div class="progress" style="width: 100px;">
                                        <div class="progress-bar" style="width: 92%"></div>
                                    </div>
                                    <small>92%</small>
                                </td>
                                <td><span class="badge badge-success">已发送</span></td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="editNotification('新培训课程发布', 'training', '技术部全体学员', '2024-01-15 14:30', '已发送')">编辑</button>
                                    <button class="btn btn-secondary btn-sm" onclick="viewNotificationDetail('新培训课程发布', 'training', '技术部全体学员', '2024-01-15 14:30', '已发送', 92)">查看</button>
                                    <button class="btn btn-warning btn-sm" onclick="resendNotification('新培训课程发布', 'EMP002')">重发</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteNotification('新培训课程发布', 'EMP002')">删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="notification-checkbox"></td>
                                <td>
                                    <div>
                                        <strong>培训催办通知</strong>
                                        <br>
                                        <small class="text-muted">提醒未完成培训的学员</small>
                                    </div>
                                </td>
                                <td><span class="badge badge-warning">催办通知</span></td>
                                <td>维修部全体学员</td>
                                <td>2024-01-15 10:15</td>
                                <td>
                                    <div class="progress" style="width: 100px;">
                                        <div class="progress-bar" style="width: 78%"></div>
                                    </div>
                                    <small>78%</small>
                                </td>
                                <td><span class="badge badge-success">已发送</span></td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="editNotification('培训催办通知', 'reminder', '维修部全体学员', '2024-01-15 10:15', '已发送')">编辑</button>
                                    <button class="btn btn-secondary btn-sm" onclick="viewNotificationDetail('培训催办通知', 'reminder', '维修部全体学员', '2024-01-15 10:15', '已发送', 78)">查看</button>
                                    <button class="btn btn-warning btn-sm" onclick="resendNotification('培训催办通知', 'EMP003')">重发</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteNotification('培训催办通知', 'EMP003')">删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="notification-checkbox"></td>
                                <td>
                                    <div>
                                        <strong>系统维护通知</strong>
                                        <br>
                                        <small class="text-muted">系统将于今晚进行维护升级</small>
                                    </div>
                                </td>
                                <td><span class="badge badge-info">系统通知</span></td>
                                <td>全体用户</td>
                                <td>2024-01-17 02:00</td>
                                <td>-</td>
                                <td><span class="badge badge-warning">定时发送</span></td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="editNotification('系统维护通知', 'system', '全体用户', '2024-01-17 02:00', '定时发送')">编辑</button>
                                    <button class="btn btn-secondary btn-sm" onclick="viewNotificationDetail('系统维护通知', 'system', '全体用户', '2024-01-17 02:00', '定时发送', 0)">查看</button>
                                    <button class="btn btn-danger btn-sm" onclick="cancelScheduledNotification('系统维护通知', 'EMP004')">取消</button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="notification-checkbox"></td>
                                <td>
                                    <div>
                                        <strong>月度培训总结</strong>
                                        <br>
                                        <small class="text-muted">1月份培训完成情况总结</small>
                                    </div>
                                </td>
                                <td><span class="badge badge-info">系统通知</span></td>
                                <td>全体管理员</td>
                                <td>-</td>
                                <td>-</td>
                                <td><span class="badge badge-secondary">草稿</span></td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="editNotification('月度培训总结', 'system', '全体管理员', '', '草稿')">编辑</button>
                                    <button class="btn btn-secondary btn-sm" onclick="viewNotificationDetail('月度培训总结', 'system', '全体管理员', '', '草稿', 0)">查看</button>
                                    <button class="btn btn-success btn-sm" onclick="sendDraftNotification('月度培训总结', 'EMP005')">发送</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteNotification('月度培训总结', 'EMP005')">删除</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- 通知模板 -->
        <!-- <div class="card">
            <div class="card-header">
                <h2 class="card-title">通知模板</h2>
            </div>
            <div class="card-body">
                <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="addTemplate()">➕ 添加模板</button>
                    <button class="btn btn-success" onclick="importTemplate()">📥 导入模板</button>
                    <button class="btn btn-warning" onclick="exportTemplate()">📤 导出模板</button>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                    <div style="border: 1px solid #ddd; border-radius: 10px; padding: 20px; background: #f8f9fa;">
                        <h4 style="margin-bottom: 10px;">培训通知模板</h4>
                        <p style="color: #666; font-size: 14px; margin-bottom: 15px;">用于通知学员新培训课程发布</p>
                        <div style="margin-bottom: 15px;">
                            <span class="badge badge-info">培训通知</span>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary btn-sm">使用</button>
                            <button class="btn btn-secondary btn-sm">编辑</button>
                            <button class="btn btn-danger btn-sm">删除</button>
                        </div>
                    </div>
                    
                    <div style="border: 1px solid #ddd; border-radius: 10px; padding: 20px; background: #f8f9fa;">
                        <h4 style="margin-bottom: 10px;">考试通知模板</h4>
                        <p style="color: #666; font-size: 14px; margin-bottom: 15px;">用于通知学员参加考试</p>
                        <div style="margin-bottom: 15px;">
                            <span class="badge badge-danger">考试通知</span>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary btn-sm">使用</button>
                            <button class="btn btn-secondary btn-sm">编辑</button>
                            <button class="btn btn-danger btn-sm">删除</button>
                        </div>
                    </div>
                    
                    <div style="border: 1px solid #ddd; border-radius: 10px; padding: 20px; background: #f8f9fa;">
                        <h4 style="margin-bottom: 10px;">催办通知模板</h4>
                        <p style="color: #666; font-size: 14px; margin-bottom: 15px;">用于催办未完成培训的学员</p>
                        <div style="margin-bottom: 15px;">
                            <span class="badge badge-warning">催办通知</span>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary btn-sm">使用</button>
                            <button class="btn btn-secondary btn-sm">编辑</button>
                            <button class="btn btn-danger btn-sm">删除</button>
                        </div>
                    </div>
                    
                    <div style="border: 1px solid #ddd; border-radius: 10px; padding: 20px; background: #f8f9fa;">
                        <h4 style="margin-bottom: 10px;">系统通知模板</h4>
                        <p style="color: #666; font-size: 14px; margin-bottom: 15px;">用于系统维护、更新等通知</p>
                        <div style="margin-bottom: 15px;">
                            <span class="badge badge-info">系统通知</span>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary btn-sm">使用</button>
                            <button class="btn btn-secondary btn-sm">编辑</button>
                            <button class="btn btn-danger btn-sm">删除</button>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->
        
        <!-- 发送统计 -->
        <!-- <div class="card">
            <div class="card-header">
                <h2 class="card-title">发送统计</h2>
            </div>
            <div class="card-body">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon blue">📊</div>
                        <div class="stat-number">89%</div>
                        <div class="stat-label">平均阅读率</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green">📱</div>
                        <div class="stat-number">1,156</div>
                        <div class="stat-label">今日发送</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orange">⏱️</div>
                        <div class="stat-number">2.5</div>
                        <div class="stat-label">平均响应时间(分钟)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon red">📈</div>
                        <div class="stat-number">+15%</div>
                        <div class="stat-label">本月增长</div>
                    </div>
                </div>
            </div>
        </div> -->
    </div>

    <script>
        // 全选/取消全选
        function toggleSelectAll() {
            const selectAll = document.querySelector('input[type="checkbox"]');
            const checkboxes = document.querySelectorAll('.notification-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAll.checked;
            });
        }
        
        // 创建通知
        function createNotification() {
            // 跳转到创建通知页面
            window.location.href = 'notification-create.html';
        }
        
        // 发送通知
        function sendNotification() {
            const selected = document.querySelectorAll('.notification-checkbox:checked');
            if (selected.length === 0) {
                alert('请先选择要发送的通知');
                return;
            }
            if (confirm(`确定要发送选中的 ${selected.length} 个通知吗？`)) {
                alert('正在发送通知...');
            }
        }
        
        // 定时发送
        function scheduleNotification() {
            // 跳转到定时发送页面
            window.location.href = 'notification-schedule.html';
        }
        
        // 编辑通知
        function editNotification(title, type, recipients, sendTime, status) {
            // 跳转到编辑通知页面，传递参数
            const params = new URLSearchParams({
                title: title,
                type: type,
                recipients: recipients,
                sendTime: sendTime,
                status: status
            });
            window.location.href = `notification-edit.html?${params.toString()}`;
        }
        
        // 查看通知详情
        function viewNotificationDetail(title, type, recipients, sendTime, status, readRate) {
            // 跳转到通知详情页面
            const params = new URLSearchParams({
                title: title,
                type: type,
                recipients: recipients,
                sendTime: sendTime,
                status: status,
                readRate: readRate
            });
            window.location.href = `notification-detail.html?${params.toString()}`;
        }
        
        // 重发通知
        function resendNotification(title, notificationId) {
            if (confirm(`确定要重新发送通知"${title}"吗？`)) {
                // 模拟重发操作
                alert(`正在重新发送通知"${title}"...`);
                setTimeout(() => {
                    alert('通知重发成功！');
                    // 这里可以刷新页面或更新状态
                    location.reload();
                }, 1000);
            }
        }
        
        // 删除通知
        function deleteNotification(title, notificationId) {
            if (confirm(`确定要删除通知"${title}"吗？\n\n删除后将无法恢复！`)) {
                // 模拟删除操作
                alert(`正在删除通知"${title}"...`);
                setTimeout(() => {
                    alert('通知删除成功！');
                    // 这里可以刷新页面或移除对应行
                    location.reload();
                }, 1000);
            }
        }
        
        // 取消定时发送
        function cancelScheduledNotification(title, notificationId) {
            if (confirm(`确定要取消定时发送通知"${title}"吗？`)) {
                // 模拟取消操作
                alert(`正在取消定时发送通知"${title}"...`);
                setTimeout(() => {
                    alert('定时发送已取消！');
                    // 这里可以刷新页面或更新状态
                    location.reload();
                }, 1000);
            }
        }
        
        // 发送草稿通知
        function sendDraftNotification(title, notificationId) {
            if (confirm(`确定要发送草稿通知"${title}"吗？`)) {
                // 模拟发送操作
                alert(`正在发送通知"${title}"...`);
                setTimeout(() => {
                    alert('通知发送成功！');
                    // 这里可以刷新页面或更新状态
                    location.reload();
                }, 1000);
            }
        }
        
        // 模板管理
        function templateManagement() {
            alert('跳转到模板管理页面');
        }
        
        // 添加模板
        function addTemplate() {
            alert('跳转到添加模板页面');
        }
        
        // 导入模板
        function importTemplate() {
            alert('跳转到导入模板页面');
        }
        
        // 导出模板
        function exportTemplate() {
            alert('正在导出模板...');
        }
        
        // 角色切换功能
        function switchRole(role) {
            // 移除所有active类
            document.querySelectorAll('.role-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // 添加active类到当前按钮
            event.target.classList.add('active');
            
            // 根据角色跳转到对应页面
            if (role === 'student') {
                window.location.href = '../student/dashboard_simple.html';
            } else if (role === 'admin') {
                window.location.href = 'dashboard_simple.html';
            }
        }

        // 退出功能
        function logout() {
            if (confirm('确定要退出系统吗？')) {
                window.location.href = '../index.html';
            }
        }

        // 更新用户信息
        function updateUserInfo(username) {
            document.getElementById('currentUser').textContent = username;
        }
    </script>
</body>
</html>
